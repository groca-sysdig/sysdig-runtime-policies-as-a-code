{
  "version": 4,
  "terraform_version": "1.3.7",
  "serial": 28,
  "lineage": "35fc6e83-852d-a6c8-20dd-6da785318023",
  "outputs": {
    "notification_id": {
      "value": "40366",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "managed",
      "type": "sysdig_secure_notification_channel_email",
      "name": "sample_email",
      "provider": "provider[\"registry.terraform.io/sysdiglabs/sysdig\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "enabled": true,
            "id": "40366",
            "name": "Example Channel - Email",
            "notify_when_ok": false,
            "notify_when_resolved": false,
            "recipients": [
              "gonzalo.rocamador@sysdig.com",
              "testuser@mail.com"
            ],
            "send_test_notification": false,
            "timeouts": null,
            "version": 1
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDAsInVwZGF0ZSI6MzAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "sysdig_secure_policy",
      "name": "workload-policy-gitops",
      "provider": "provider[\"registry.terraform.io/sysdiglabs/sysdig\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "actions": [
              {
                "capture": [
                  {
                    "name": "gitops-security-capture",
                    "seconds_after_event": 10,
                    "seconds_before_event": 5
                  }
                ],
                "container": "stop"
              }
            ],
            "description": "custom managed policy operated with GitOps approach: GitHub actions + TF",
            "enabled": true,
            "id": "10021238",
            "name": "workload-policy-gitops",
            "notification_channels": [
              40366
            ],
            "rule_names": [
              "gitops - Terminal shell in container"
            ],
            "runbook": "https://runbook.com",
            "scope": "container.id != \"\"",
            "severity": 4,
            "timeouts": null,
            "type": "falco",
            "version": 3
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDAsInVwZGF0ZSI6MzAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "sysdig_secure_rule_falco",
      "name": "falco_example_rule",
      "provider": "provider[\"registry.terraform.io/sysdiglabs/sysdig\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "append": false,
            "condition": "spawned_process and container and shell_procs and proc.tty != 0 and container_entrypoint",
            "description": "A shell was used as the entrypoint/exec point into a container with an attached terminal.",
            "exceptions": [
              {
                "comps": [
                  "in"
                ],
                "fields": [
                  "proc.name"
                ],
                "name": "proc_names",
                "values": "[[[\"python\",\"python2\",\"python3\"]]]"
              },
              {
                "comps": [
                  "=",
                  "in"
                ],
                "fields": [
                  "container.id",
                  "proc.name"
                ],
                "name": "container_proc_name",
                "values": "[[\"host\",[\"docker_binaries\",\"k8s_binaries\",\"lxd_binaries\",\"nsenter\"]]]"
              },
              {
                "comps": [
                  "in",
                  "contains"
                ],
                "fields": [
                  "proc.name",
                  "proc.cmdline"
                ],
                "name": "proc_cmdline",
                "values": "[[[\"python\",\"python2\",\"python3\"],\"/opt/draios/bin/sdchecks\"],[[\"java\"],\"sdjagent.jar\"]]"
              }
            ],
            "id": "10009949",
            "name": "gitops - Terminal shell in container",
            "output": "A shell was spawned in a container with an attached terminal (user=%user.name %container.info shell=%proc.name parent=%proc.pname cmdline=%proc.cmdline terminal=%proc.tty container_id=%container.id image=%container.image.repository)",
            "priority": "notice",
            "source": "syscall",
            "tags": [
              "gitops",
              "container",
              "shell",
              "mitre_execution"
            ],
            "timeouts": null,
            "version": 2
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDAsInVwZGF0ZSI6MzAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "sysdig_secure_rule_falco",
      "name": "falco_example_rule_2",
      "provider": "provider[\"registry.terraform.io/sysdiglabs/sysdig\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "append": false,
            "condition": "outbound and fd.sip=\"169.254.169.254\" and ec2_metadata_containers",
            "description": "Detect attempts to contact the EC2 Instance Metadata Service from a container",
            "exceptions": [],
            "id": "10009951",
            "name": "gitops - Connect EC2 Instance Metadata from container",
            "output": "Outbound connection to EC2 instance metadata service (proc.cmdline=%proc.cmdline connection=%fd.name %container.info evt.type=%evt.type evt.res=%evt.res proc.pid=%proc.pid proc.cwd=%proc.cwd proc.ppid=%proc.ppid proc.pcmdline=%proc.pcmdline proc.sid=%proc.sid proc.exepath=%proc.exepath user.uid=%user.uid user.loginuid=%user.loginuid user.loginname=%user.loginname user.name=%user.name group.gid=%group.gid group.name=%group.name container.id=%container.id container.name=%container.name image=%container.image.repository:%container.image.tag)",
            "priority": "notice",
            "source": "syscall",
            "tags": [
              "gitops",
              "aws",
              "mitre_exfiltration"
            ],
            "timeouts": null,
            "version": 1
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDAsInVwZGF0ZSI6MzAwMDAwMDAwMDAwfX0="
        }
      ]
    }
  ],
  "check_results": null
}
